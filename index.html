<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>チャージ料金計算</title>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#e4ab9b">
<link rel="icon" href="icon-192.png">

<style>
  /* フォントを読み込む（tanuki-magic.woff を同じフォルダに置いてください） */
 @font-face {
  font-family: "TanukiMagic";
  src: url("tanuki-magic.woff2") format("woff2"),
       url("tanuki-magic.woff") format("woff");
  font-weight: normal;
  font-style: normal;
}
 body {
  font-family: system-ui, sans-serif;
  background-color: #ffd1dc;
  padding: 18px;
}


h2 {
  font-family: "TanukiMagic", cursive;
  color: #e75480; /* ローズピンク */
  font-size: 36px;
  font-weight: normal;

  /* 縁取り → 半分の太さ */
  -webkit-text-stroke: 1px white;

  /* 疑似太字 → text-shadowを内側っぽく重ねる */
  text-shadow: 
    0.5px 0 0 #e75480,
   -0.5px 0 0 #e75480,
    0 0.5px 0 #e75480,
    0 -0.5px 0 #e75480;
}

  label, input, select, button {
    display: block;
    margin: 8px 0;
    font-size: 16px;
  }

  button {
    padding: 8px 12px;
    border: none;
    border-radius: 8px;
    background-color: #e75480;
    color: white;
    font-weight: bold;
  }

  .result {
    margin-top: 12px;
    font-weight: bold;
  }

  pre {
    background: #fff;
    padding: 8px;
    border-radius: 6px;
    font-size: 14px;
  }
</style>
</head>
<body>
  <h2>チャージ料金計算</h2>

  <label>性別
    <select id="gender">
      <option value="male">男性</option>
      <option value="female">女性</option>
    </select>
  </label>

  <label>入店時間
    <input type="time" id="startTime" step="900">
  </label>

  <label>退店時間
    <input type="time" id="endTime" step="900">
  </label>

  <button onclick="calculate()">計算する</button>

  <div class="result" id="result">料金: - 円</div>
  <pre id="breakdown"></pre>

<script>
function getRates(gender, isBar) {
  if (gender === "male") {
    return isBar ? { first30:500, add15:400 } : { first30:400, add15:300 };
  } else {
    return isBar ? { first30:500, add15:300 } : { first30:400, add15:200 };
  }
}

function parseTimeToDate(t) {
  return new Date("2000-01-01T" + t + ":00");
}

function calculate() {
  const gender = document.getElementById("gender").value;
  const startStr = document.getElementById("startTime").value;
  const endStr = document.getElementById("endTime").value;
  const out = document.getElementById("result");
  const bd = document.getElementById("breakdown");

  if (!startStr || !endStr) {
    alert("入店時間と退店時間を入力してください");
    return;
  }

  let startDate = parseTimeToDate(startStr);
  let endDate = parseTimeToDate(endStr);
  if (endDate <= startDate) endDate.setDate(endDate.getDate() + 1);

  const initialIsBar = startDate.getHours() >= 22;
  const rates = getRates(gender, initialIsBar);
  let total = rates.first30;
  let breakdown = [];
  breakdown.push(`初回30分（${initialIsBar ? "バー" : "カフェ"}）: ${rates.first30}円`);

  const after30 = new Date(startDate.getTime() + 30*60000);

  let blockStart = new Date(after30);
  while (blockStart < endDate) {
    let isBar = blockStart.getHours() >= 22;
    const rate = getRates(gender, isBar).add15;
    total += rate;
    breakdown.push(`${blockStart.getHours().toString().padStart(2,"0")}:${blockStart.getMinutes().toString().padStart(2,"0")}〜 (${isBar ? "バー" : "カフェ"}) ${rate}円`);
    blockStart = new Date(blockStart.getTime() + 15*60000);
  }

  out.innerText = `料金: ${total} 円`;
  bd.innerText = breakdown.join("\n");
}

// Service Worker 登録
if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("service-worker.js");
}
</script>
</body>
</html>





